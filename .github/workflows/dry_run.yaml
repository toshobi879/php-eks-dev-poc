dry_run_rds:
  runs-on: ubuntu-latest
  environment: dev   # ðŸ”¥ THIS IS REQUIRED

  steps:
    - uses: actions/checkout@v5

    - name: Configure AWS credentials
      uses: aws-actions/configure-aws-credentials@v4
      with:
        role-to-assume: ${{ secrets.AWS_ROLE_ARN }}
        aws-region: us-west-2

    - name: Export DB password
      run: |
        echo "TF_VAR_db_password=${{ secrets.TF_VAR_DB_PASSWORD }}" >> $GITHUB_ENV

    - uses: hashicorp/setup-terraform@v3

    - name: Terraform Init
      working-directory: terraform/rds
      run: terraform init -input=false

    - name: Terraform Plan (Destroy)
      working-directory: terraform/rds
      run: terraform plan -destroy
